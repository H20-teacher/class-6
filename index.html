<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€ë¸Œë¦¬ ìˆ² ë§ˆì„ - ìš°ë¦¬ë“¤ì˜ êµì‹¤</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@300;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #fcf8f3;
            --main-green: #6aaa6a;
            --main-brown: #a07869;
            --light-blue: #a8d5e5;
            --text-dark: #3a3a3a;
            --card-bg: rgba(255, 255, 255, 0.85);
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-dark);
            font-family: 'Jua', cursive;
            margin: 0; padding: 0;
            /* ì§€ë¸Œë¦¬ ëŠë‚Œì˜ ìˆ² ë°°ê²½ (ë¬´ë£Œ ì´ë¯¸ì§€ ì†ŒìŠ¤) */
            background-image: linear-gradient(to bottom, rgba(252,248,243,0.3), rgba(252,248,243,0.3)), url('https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
        }

        .container {
            max-width: 900px;
            margin: 30px auto;
            padding: 25px;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(8px);
            border-radius: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .village-header { text-align: center; padding: 20px 0; }
        .village-header h1 {
            font-size: 3.2rem;
            color: var(--main-green);
            margin: 0;
            text-shadow: 2px 2px 0px #fff;
        }

        .date-mood {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 1rem;
            color: var(--main-brown);
            margin-top: 10px;
            background: white;
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
        }

        .section-box {
            background: var(--card-bg);
            border-radius: 25px;
            padding: 25px;
            margin-top: 25px;
            border: 2px solid #fff;
            box-shadow: 0 8px 15px rgba(0,0,0,0.05);
        }

        .section-title {
            font-size: 1.8rem;
            color: var(--main-brown);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* í•™ìƒ ì¹´ë“œ ê·¸ë¦¬ë“œ (6ëª…ì— ìµœì í™”ëœ 3ì—´) */
        .house-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .house-card {
            background: #fff;
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            transition: 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .house-card:hover {
            transform: translateY(-7px);
            border-color: var(--main-green);
            box-shadow: 0 10px 20px rgba(106, 170, 106, 0.2);
        }

        .house-card .icon { font-size: 2.5rem; margin-bottom: 5px; }
        .house-card .name { font-size: 1.3rem; color: var(--text-dark); }
        .house-card .level { font-family: 'Noto Sans KR'; font-size: 0.8rem; color: var(--main-green); }

        /* í”„ë¡œê·¸ë ˆìŠ¤ ë°” */
        .garden-progress {
            background: #eee; height: 12px; border-radius: 10px; overflow: hidden; margin-top: 10px;
        }
        .garden-bar {
            background: var(--main-green); width: 70%; height: 100%; border-radius: 10px;
        }

        @media (max-width: 600px) {
            .house-grid { grid-template-columns: repeat(2, 1fr); }
            .village-header h1 { font-size: 2.2rem; }
        }
    </style>
</head>
<body>

<div class="container">
    <header class="village-header">
        <h1>ğŸŒ³ ìˆ²ì† ìš°ë¦¬ë“¤ì˜ êµì‹¤</h1>
        <div id="todayDate" class="date-mood"></div>
    </header>

    <div class="section-box">
        <div class="section-title">ğŸ“® ìˆ²ì† ìš°ì²´í†µ</div>
        <div style="font-family: 'Noto Sans KR'; line-height: 1.8;">
            â€¢ ì˜¤ëŠ˜ 5êµì‹œ ì²´ìœ¡ê´€ìœ¼ë¡œ ëª¨ì´ì„¸ìš”!<br>
            â€¢ ë…ì„œ ê¸°ë¡ì¥ ì œì¶œì€ ë‚´ì¼ê¹Œì§€ì…ë‹ˆë‹¤.
        </div>
    </div>

    <div class="section-box">
        <div class="section-title">ğŸŒ± ìë¼ë‚˜ëŠ” ë§ˆìŒ ì •ì›</div>
        <div class="garden-progress"><div class="garden-bar"></div></div>
        <p style="font-family: 'Noto Sans KR'; font-size: 0.8rem; text-align: right; margin-top:5px;">ê½ƒì´ í”¼ê¸°ê¹Œì§€ 30% ë‚¨ì•˜ì–´ìš”!</p>
    </div>

    <div class="section-box">
        <div class="section-title">ğŸ  ìš°ë¦¬ë“¤ì˜ ì‘ì€ ì§‘</div>
        <div class="house-grid" id="studentGrid">
            <p style="grid-column: span 3; text-align: center; font-family: 'Noto Sans KR';">ìˆ²ì† ì¹œêµ¬ë“¤ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
    </div>
</div>

<script>
    // 1. ë‚ ì§œ ì„¤ì •
    const d = new Date();
    document.getElementById('todayDate').innerText = d.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' });

    // 2. â˜… ì¤‘ìš”: ì„ ìƒë‹˜ì˜ êµ¬ê¸€ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ URLì„ ì—¬ê¸°ì— ë„£ìœ¼ì„¸ìš” â˜…
    const apiURL = "https://script.google.com/macros/s/AKfycbyGUZBa1KSiCYzhgvjor7_7L8rLuHjWDowZKz_aMajnGsc-9nw7vNL5Cj6evwfar7ka/exec";

    async function loadStudents() {
        const grid = document.getElementById('studentGrid');
        try {
            const res = await fetch(apiURL);
            const data = await res.json();
            grid.innerHTML = ""; // ë¡œë”© ë©”ì‹œì§€ ì‚­ì œ

            data.forEach((s, index) => {
                const card = document.createElement('div');
                card.className = 'house-card';
                
                // ë‚¨ì—¬ ë¹„ìœ¨ì— ë§ì¶° ì•„ì´ì½˜ ìë™ ë°°ì • (ë˜ëŠ” ì‹œíŠ¸ ë°ì´í„° í™œìš© ê°€ëŠ¥)
                const icons = ['ğŸŒ¸', 'ğŸ€', 'ğŸ¦‹', 'ğŸ¿ï¸', 'ğŸŒ²', 'â›µ']; 
                const icon = icons[index % icons.length];

                card.innerHTML = `
                    <div class="icon">${icon}</div>
                    <div class="name">${s.name}</div>
                    <div class="level">ì„±ì¥ ë ˆë²¨ ${s.level || 1}</div>
                `;

                card.onclick = () => {
                    if (s.htmlCode) {
                        const win = window.open();
                        win.document.write(s.htmlCode);
                        win.document.close();
                    } else {
                        alert(s.name + "ì˜ ê³µê°„ì€ ì•„ì§ ê³µì‚¬ ì¤‘ì´ì—ìš”!");
                    }
                };
                grid.appendChild(card);
            });
        } catch (e) {
            grid.innerHTML = "<p style='grid-column:span 3;'>ì¹œêµ¬ë“¤ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆì–´ìš”. URLì„ í™•ì¸í•´ì£¼ì„¸ìš”!</p>";
        }
    }

    loadStudents();
</script>

</body>
</html>
